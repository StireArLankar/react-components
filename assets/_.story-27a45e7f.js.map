{"version":3,"file":"_.story-27a45e7f.js","sources":["../../src/components/native/Color/ColorDisplay.tsx","../../src/components/native/Color/FileInput.tsx","../../src/components/native/Color/index.tsx","../../src/components/native/Color/_.story.tsx"],"sourcesContent":["import React from 'react'\r\n\r\nimport style from './color.module.scss'\r\n\r\nexport interface ColorDisplayProps {\r\n  color: [number, number, number]\r\n}\r\n\r\nexport const ColorDisplay = (props: ColorDisplayProps) => {\r\n  const { color } = props\r\n\r\n  const rgbToHex = (r: number, g: number, b: number) => {\r\n    if (r > 255 || g > 255 || b > 255) {\r\n      throw new Error('Invalid color component')\r\n    }\r\n    const temp = ((r << 16) | (g << 8) | b).toString(16)\r\n    return '#' + ('000000' + temp).slice(-6)\r\n  }\r\n\r\n  return (\r\n    <div className={style.colorWrapper}>\r\n      <span\r\n        style={{ backgroundColor: `rgb(${color.toString()})` }}\r\n        className={style.square}\r\n      />\r\n      <span className={style.text}>Rgb: {color.slice(0, 3).toString()}</span>\r\n      <span className={style.text}>Hex: {rgbToHex(...color)}</span>\r\n    </div>\r\n  )\r\n}\r\n\r\nexport default ColorDisplay\r\n","import React, { ChangeEvent } from 'react'\r\n\r\nimport style from './color.module.scss'\r\n\r\ninterface FileInputProps {\r\n  onFileUpload: (evt: ChangeEvent<HTMLInputElement>) => void\r\n}\r\n\r\nconst FileInput = (props: FileInputProps) => {\r\n  const { onFileUpload } = props\r\n\r\n  return (\r\n    <label className={style.labelWrapper}>\r\n      <input\r\n        type='file'\r\n        accept='image/*'\r\n        onChange={onFileUpload}\r\n        className={style.input}\r\n      />\r\n      <span className={style.label}>Выберите изображение</span>\r\n    </label>\r\n  )\r\n}\r\n\r\nexport default FileInput\r\n","import React, {\r\n  useRef,\r\n  useState,\r\n  Fragment,\r\n  MouseEvent,\r\n  ChangeEvent,\r\n} from 'react'\r\n\r\nimport useBGColor from '~/hook/useBgColor'\r\n\r\nimport classes from './color.module.scss'\r\nimport ColorDisplay from './ColorDisplay'\r\nimport FileInput from './FileInput'\r\n\r\nexport const Color = () => {\r\n  const [moveColor, setMoveColor] = useState<[number, number, number]>([\r\n    0, 0, 0,\r\n  ])\r\n  const [clickColor, setClickColor] = useState<[number, number, number]>([\r\n    0, 0, 0,\r\n  ])\r\n  const [uploaded, setUploaded] = useState(false)\r\n  const [sizes, setSizes] = useState({\r\n    width: 0,\r\n    height: 0,\r\n  })\r\n\r\n  const canvas = useRef<HTMLCanvasElement>(null)\r\n\r\n  useBGColor(210, 208, 233)\r\n\r\n  const getEventLocation = (element: HTMLElement, evt: MouseEvent) => {\r\n    const bound = element.getBoundingClientRect()\r\n    const x = bound.x\r\n    const y = bound.y + document.documentElement.scrollTop\r\n\r\n    return {\r\n      x: evt.pageX - x,\r\n      y: evt.pageY - y,\r\n    }\r\n  }\r\n\r\n  const getImgSizes = (img: HTMLImageElement) => {\r\n    const { width, height } = img\r\n    if (width > height && width > 500) {\r\n      return [500, (500 * height) / width]\r\n    } else if (height > width && height > 500) {\r\n      return [(500 * width) / height, 500]\r\n    }\r\n    return [width, height]\r\n  }\r\n\r\n  const drawImageFromWebUrl = (url: string) => {\r\n    var img = new Image()\r\n\r\n    img.onload = () => {\r\n      const [width, height] = getImgSizes(img)\r\n      setSizes({ width, height })\r\n\r\n      canvas.current?.getContext('2d')?.drawImage(img, 0, 0, width, height)\r\n    }\r\n\r\n    img.setAttribute('src', url)\r\n  }\r\n\r\n  const getColorFrom = (name: 'move' | 'click') => {\r\n    const setColor = name === 'move' ? setMoveColor : setClickColor\r\n\r\n    return (e: MouseEvent) => {\r\n      if (canvas.current) {\r\n        const eventLocation = getEventLocation(canvas.current, e)\r\n        const context = canvas.current.getContext('2d')\r\n        const pixelData = context?.getImageData(\r\n          eventLocation.x,\r\n          eventLocation.y,\r\n          1,\r\n          1\r\n        ).data\r\n        if (pixelData) {\r\n          const array = Array.from(pixelData) as [number, number, number]\r\n          setColor(array)\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  const onFileUpload = (e: ChangeEvent<HTMLInputElement>) => {\r\n    const file = (e.target.files as FileList)[0]\r\n    const reader = new FileReader()\r\n\r\n    reader.onload = () => {\r\n      const url = reader.result as string\r\n      setUploaded(true)\r\n      drawImageFromWebUrl(url)\r\n    }\r\n\r\n    reader.readAsDataURL(file)\r\n  }\r\n\r\n  const renderField = () => {\r\n    return (\r\n      <Fragment>\r\n        <div className={classes.left}>\r\n          <canvas\r\n            width={sizes.width}\r\n            height={sizes.height}\r\n            onMouseMove={getColorFrom('move')}\r\n            onClick={getColorFrom('click')}\r\n            ref={canvas}\r\n            className={classes.canvas}\r\n          />\r\n        </div>\r\n        <div className={classes.right}>\r\n          <ColorDisplay color={moveColor} />\r\n          <ColorDisplay color={clickColor} />\r\n        </div>\r\n        <FileInput onFileUpload={onFileUpload} />\r\n      </Fragment>\r\n    )\r\n  }\r\n\r\n  return (\r\n    <div className={classes.wrapper}>\r\n      {uploaded ? renderField() : <FileInput onFileUpload={onFileUpload} />}\r\n    </div>\r\n  )\r\n}\r\n\r\nexport default Color\r\n","import { ComponentStory } from '@storybook/react';\nimport { withCenteredStyle } from '~/_storybook/withCenteredStyle';\nimport { withCustomTheme } from '~/_storybook/withCustomTheme';\nimport { ColorDisplay } from './ColorDisplay';\nimport { Color } from '.';\nexport default {\n  title: 'Native/Color Picker',\n  decorators: [withCenteredStyle({\n    width: '100%',\n    padding: 20\n  }), withCustomTheme]\n};\nexport const ColorPicker = () => <Color />;\ntype Props = {\n  red: number;\n  green: number;\n  blue: number;\n};\nconst Asd = (props: Props) => <ColorDisplay color={[props.red, props.green, props.blue]} />;\nconst Template: ComponentStory<typeof Asd> = props => <Asd {...props} />;\nexport const Display = Template.bind({});\nDisplay.args = {\n  red: 0,\n  green: 0,\n  blue: 0\n};\nColorPicker.parameters = {\n  ...ColorPicker.parameters,\n  storySource: {\n    source: \"() => <Color />\",\n    ...ColorPicker.parameters?.storySource\n  }\n};\nDisplay.parameters = {\n  ...Display.parameters,\n  storySource: {\n    source: \"props => <Asd {...props} />\",\n    ...Display.parameters?.storySource\n  }\n};"],"names":["ColorDisplay","props","color","rgbToHex","r","g","b","jsxs","style","jsx","FileInput","onFileUpload","Color","moveColor","setMoveColor","useState","clickColor","setClickColor","uploaded","setUploaded","sizes","setSizes","canvas","useRef","useBGColor","getEventLocation","element","evt","bound","x","y","getImgSizes","img","width","height","drawImageFromWebUrl","url","_b","_a","getColorFrom","name","setColor","e","eventLocation","context","pixelData","array","file","reader","renderField","Fragment","classes","__story","withCenteredStyle","withCustomTheme","ColorPicker","Asd","Template","Display"],"mappings":"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"}
{"version":3,"file":"_.story-588213e2.js","sources":["../../src/components/gesture/BottomSheet/filter.svg","../../src/components/gesture/BottomSheet/index.tsx","../../src/components/gesture/BottomSheet/_.story.tsx"],"sourcesContent":["export default \"__VITE_ASSET__da7a1226__\"","import React, { useState } from 'react'\r\nimport useMeasure from 'react-use-measure'\r\n\r\nimport { useSpring, animated } from '@react-spring/web'\r\nimport { useDrag } from '@use-gesture/react'\r\nimport { assignInlineVars } from '@vanilla-extract/dynamic'\r\n\r\nimport classes, { backgroundVar } from './_classes.css'\r\nimport { ReactComponent as Filter } from './filter.svg'\r\n\r\nconst trans = (y: number, c: number) =>\r\n  `translateX(-50%) rotate(45deg) skew(${y * c}deg, ${y * c}deg)`\r\n\r\n/** лимиты для макс смещения по оси y при открытой модалке */\r\nconst dragOptions1 = {\r\n  bounds: { top: -15, bottom: 50 },\r\n}\r\n\r\n/** лимиты для макс смещения по оси y при закрытой модалке */\r\nconst dragOptions2 = {\r\n  bounds: { top: -65, bottom: 20 },\r\n}\r\n\r\nconst initialState = { y: 0, y2: -20 }\r\n\r\nexport default ({ children }: React.PropsWithChildren<{}>) => {\r\n  const [{ y, y2 }, spring] = useSpring(() => initialState)\r\n\r\n  const [isOpen, setIsOpen] = useState(false)\r\n\r\n  const [ref, { height }] = useMeasure()\r\n\r\n  const dragOptions = isOpen ? dragOptions1 : dragOptions2\r\n\r\n  const bind = useDrag(\r\n    ({ movement: [, y], down }) => {\r\n      switch (true) {\r\n        // если палец / мышка нажаты\r\n        case down:\r\n          // если открыта, то считаем y возле верхнего края\r\n          // если закрыта, то у нижнего\r\n          spring.start({ y: isOpen ? height - y : -y, y2: -y - 20 })\r\n          break\r\n\r\n        // когда отжимается палец:\r\n\r\n        // модалка развернута и смещение вниз больше 30\r\n        // закрываем модалку\r\n        case isOpen === true && y > 30:\r\n          setIsOpen(false)\r\n          spring.start(initialState)\r\n          break\r\n\r\n        // модалка развернута и смещения недостаточно\r\n        // оставляем модалку раскрытой\r\n        case isOpen === true:\r\n          spring.start({ y: height, y2: -20 })\r\n          break\r\n\r\n        // модалка закрыта и смещение вверх больше 30\r\n        // открываем модалку\r\n        case isOpen === false && y < -30:\r\n          setIsOpen(true)\r\n          spring.start({ y: height, y2: -20 })\r\n          break\r\n\r\n        // модалка закрыта и смещения недостаточно\r\n        // оставляем модалку закрытой\r\n        case isOpen === false:\r\n          spring.start(initialState)\r\n          break\r\n      }\r\n    },\r\n    {\r\n      bounds: dragOptions.bounds,\r\n      from: () => [y.get(), 0],\r\n    }\r\n  )\r\n\r\n  return (\r\n    <>\r\n      <Filter style={{ display: 'none' }} />\r\n      <animated.div\r\n        className={classes.wrapper}\r\n        style={{\r\n          ...assignInlineVars({ [backgroundVar]: 'white' }),\r\n          top: '100%',\r\n          transform: y.to((y) => `translate(-50%, ${-y + 30}px)`),\r\n        }}\r\n      >\r\n        <div className={classes.wrapperFilter}>\r\n          <animated.div\r\n            className={classes.box}\r\n            style={{\r\n              transform: y2.to((y) => trans(y, 0.3)),\r\n              touchAction: 'none',\r\n            }}\r\n            {...bind()}\r\n          />\r\n          <animated.div className={classes.planc} style={{ height: '100%' }} />\r\n        </div>\r\n        <div\r\n          ref={ref}\r\n          style={{\r\n            maxHeight: 'calc(100vh - 80px)',\r\n            position: 'relative',\r\n            padding: `15px 20px 35px`,\r\n            display: 'flex',\r\n            background: 'white',\r\n            borderRadius: 20,\r\n          }}\r\n        >\r\n          <div\r\n            style={{\r\n              overflowY: 'auto',\r\n              width: '100%',\r\n            }}\r\n          >\r\n            <button\r\n              onClick={() => {\r\n                setIsOpen(false)\r\n                spring.start(initialState)\r\n              }}\r\n            >\r\n              close\r\n            </button>\r\n            {children}\r\n          </div>\r\n        </div>\r\n      </animated.div>\r\n    </>\r\n  )\r\n}\r\n","import { withCenteredStyle } from '~/_storybook/withCenteredStyle';\nimport { withCustomTheme } from '~/_storybook/withCustomTheme';\nimport BottomSheet from '.';\nexport default {\n  title: 'Gesture/BottomSheet',\n  decorators: [withCenteredStyle({\n    width: '100%',\n    overflow: 'hidden',\n    height: '100vh',\n    display: 'grid',\n    placeItems: 'center'\n  }), withCustomTheme]\n};\nexport const SmallContent = () => <BottomSheet>\r\n    <div>small content</div>\r\n  </BottomSheet>;\nexport const LargeContent = () => <BottomSheet>\r\n    <div style={{\n    height: 1500\n  }}>large content</div>\r\n  </BottomSheet>;\nSmallContent.parameters = {\n  ...SmallContent.parameters,\n  storySource: {\n    source: \"() => <BottomSheet>\\r\\n    <div>small content</div>\\r\\n  </BottomSheet>\",\n    ...SmallContent.parameters?.storySource\n  }\n};\nLargeContent.parameters = {\n  ...LargeContent.parameters,\n  storySource: {\n    source: \"() => <BottomSheet>\\r\\n    <div style={{\\n    height: 1500\\n  }}>large content</div>\\r\\n  </BottomSheet>\",\n    ...LargeContent.parameters?.storySource\n  }\n};"],"names":["SvgFilter","props","React.createElement","trans","y","c","dragOptions1","dragOptions2","initialState","BottomSheet$1","children","y2","spring","useSpring","isOpen","setIsOpen","useState","ref","height","useMeasure","bind","useDrag","y3","down","jsxs","Fragment","jsx","Filter","animated","classes","assignInlineVars","backgroundVar","__story","withCenteredStyle","withCustomTheme","SmallContent","BottomSheet","LargeContent","_a"],"mappings":"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"}
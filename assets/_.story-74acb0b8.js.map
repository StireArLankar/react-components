{"version":3,"file":"_.story-74acb0b8.js","sources":["../../src/components/gesture/Virtualized/imgs.ts","../../src/components/gesture/Virtualized/Virtualized.tsx","../../src/components/gesture/Virtualized/_.story.tsx"],"sourcesContent":["export default [\r\n  'https://drscdn.500px.org/photo/126979479/w%3D440_h%3D440/v2?webp=true&v=2&sig=09ea71b0ddb91e24a59cecfb79a0189a2ab575d10372d3e8d3258e38f97a6a49',\r\n  'https://drscdn.500px.org/photo/435236/q%3D80_m%3D1500/v2?webp=true&sig=67031bdff6f582f3e027311e2074be452203ab637c0bd21d89128844becf8e40',\r\n  'https://drscdn.500px.org/photo/188823103/w%3D440_h%3D440/v2?webp=true&v=3&sig=af23265ed9beaeeeb12b4f8dfed14dd613e5139495ba4a80d5dcad5cef9e39fd',\r\n  'https://drscdn.500px.org/photo/216094471/w%3D440_h%3D440/v2?webp=true&v=0&sig=16a2312302488ae2ce492fb015677ce672fcecac2befcb8d8e9944cbbfa1b53a',\r\n  'https://drscdn.500px.org/photo/227760547/w%3D440_h%3D440/v2?webp=true&v=0&sig=d00bd3de4cdc411116f82bcc4a4e8a6375ed90a686df8488088bca4b02188c73',\r\n]\r\n","import { useState } from 'react'\r\n\r\nimport { animated, useSpring } from '@react-spring/web'\r\nimport { useDrag } from '@use-gesture/react'\r\n\r\nimport clamp from '~/utils/clamp'\r\n\r\nimport classes from './_classes.css'\r\nimport imgs from './imgs'\r\n\r\nconst STEP = 200\r\nconst WIDTH = 200\r\n\r\n// range: [-200, 400]\r\nconst trans = (num: number) =>\r\n  `translate3d(${(num * WIDTH) / STEP}px, 0, 0) ` +\r\n  `scale(${1.2 - (Math.abs(-100 + num) * 4) / (200 * 10)})`\r\n\r\nconst int = (x: number, i: number) => {\r\n  const itemValue = x + STEP * i\r\n\r\n  return clamp(itemValue, STEP * -1, STEP * 2)\r\n}\r\n\r\nconst arr = Array.from({ length: 200 }, () => imgs)\r\n  .flat()\r\n  .map((img, index) => ({ index, img }))\r\n\r\nconst slicer = (\r\n  isVirt: boolean,\r\n  active: number,\r\n  arr: Array<{ index: number; img: string }>\r\n) => (isVirt ? arr.slice(Math.max(active - 15, 0), active + 10) : arr)\r\n\r\nexport interface VirtualizedProps {\r\n  start?: number\r\n  isVirt?: boolean\r\n}\r\n\r\nexport const Virtualized = (props: VirtualizedProps) => {\r\n  const { start = 0, isVirt = false } = props\r\n\r\n  const [{ x }, spring] = useSpring(() => ({\r\n    x: start,\r\n    config: { mass: 5, tension: 170, friction: 80 },\r\n  }))\r\n\r\n  const [active, setActive] = useState(5)\r\n\r\n  const bind = useDrag(\r\n    ({ offset: [x] }) => {\r\n      spring.start({ x })\r\n      isVirt && setActive(Math.floor(-x / STEP) + 3)\r\n    },\r\n    {\r\n      from: () => [x.get(), 0],\r\n      bounds: { right: 0, left: -STEP * (arr.length - 2) },\r\n      rubberband: 0.3,\r\n    }\r\n  )\r\n\r\n  const renderImages = () =>\r\n    slicer(isVirt, active, arr).map((obj) => (\r\n      <animated.li\r\n        key={obj.index}\r\n        className={classes.container}\r\n        style={{ transform: x.to((val) => trans(int(val, obj.index))) }}\r\n      >\r\n        <div\r\n          className={classes.img}\r\n          style={{ backgroundImage: `url(${obj.img})` }}\r\n        />\r\n      </animated.li>\r\n    ))\r\n\r\n  return (\r\n    <div className={classes.wrapper}>\r\n      <p className={classes.text}>\r\n        {isVirt ? `Virtualized ${arr.length}` : 'Not virtualized'}\r\n      </p>\r\n      <ul className={classes.list} {...bind()}>\r\n        {renderImages()}\r\n      </ul>\r\n    </div>\r\n  )\r\n}\r\n","import { withCenteredStyle } from '~/_storybook/withCenteredStyle';\nimport { withCustomTheme } from '~/_storybook/withCustomTheme';\nimport { Virtualized } from './Virtualized';\nexport default {\n  title: 'Gesture/VirtualizedSlider',\n  decorators: [withCenteredStyle({\n    width: '100%',\n    overflow: 'hidden'\n  }), withCustomTheme]\n};\nexport const VirtualizedSlider = () => <div style={{\n  display: 'grid',\n  gridTemplateRows: '1fr 1fr',\n  gridRowGap: 20,\n  padding: 20\n}}>\r\n    <Virtualized />\r\n    <Virtualized isVirt />\r\n  </div>;\nVirtualizedSlider.parameters = {\n  ...VirtualizedSlider.parameters,\n  storySource: {\n    source: \"() => <div style={{\\n  display: 'grid',\\n  gridTemplateRows: '1fr 1fr',\\n  gridRowGap: 20,\\n  padding: 20\\n}}>\\r\\n    <Virtualized />\\r\\n    <Virtualized isVirt />\\r\\n  </div>\",\n    ...VirtualizedSlider.parameters?.storySource\n  }\n};"],"names":["imgs","STEP","WIDTH","trans","num","int","x","i","itemValue","clamp","arr","img","index","slicer","isVirt","active","arr2","Virtualized","props","start","spring","useSpring","setActive","useState","bind","useDrag","x2","renderImages","obj","jsx","animated","classes","val","jsxs","__story","withCenteredStyle","withCustomTheme","VirtualizedSlider","_a"],"mappings":"kfAAeA,EAAA,CACb,iJACA,0IACA,iJACA,iJACA,gJACF,ECIAC,EAAA,IACAC,EAAA,IAGAC,EAAAC,GAAA,eAAAA,EAAAF,EAAAD,oBAAA,IAAA,KAAA,IAAA,KAAAG,CAAA,EAAA,GAAA,IAAA,OAIAC,EAAA,CAAAC,EAAAC,IAAA,CACE,MAAAC,EAAAF,EAAAL,EAAAM,EAEA,OAAAE,EAAAD,EAAAP,EAAA,GAAAA,EAAA,CAAA,CACF,EAEAS,EAAA,MAAA,KAAA,CAAA,OAAA,GAAA,EAAA,IAAAV,CAAA,EAAA,KAAA,EAAA,IAAA,CAAAW,EAAAC,KAAA,CAAA,MAAAA,EAAA,IAAAD,CAAA,EAAA,EAIAE,EAAA,CAAAC,EAAAC,EAAAC,IAAAF,EAAAE,EAAA,MAAA,KAAA,IAAAD,EAAA,GAAA,CAAA,EAAAA,EAAA,EAAA,EAAAC,EAWOC,EAAAC,GAAA,CACL,KAAA,CAAA,MAAAC,EAAA,EAAA,OAAAL,EAAA,EAAA,EAAAI,EAEA,CAAA,CAAA,EAAAZ,CAAA,EAAAc,CAAA,EAAAC,EAAA,KAAA,CAAyC,EAAAF,EACpC,OAAA,CAAA,KAAA,EAAA,QAAA,IAAA,SAAA,EAAA,CAC2C,EAAA,EAGhD,CAAAJ,EAAAO,CAAA,EAAAC,EAAA,SAAA,CAAA,EAEAC,EAAAC,EAAa,CAAA,CAAA,OAAA,CAAAC,CAAA,KAAA,CAETN,EAAA,MAAA,CAAA,EAAAM,CAAA,CAAA,EACAZ,GAAAQ,EAAA,KAAA,MAAA,CAAAI,EAAAzB,CAAA,EAAA,CAAA,CAA6C,EAC/C,CACA,KAAA,IAAA,CAAAK,EAAA,IAAA,EAAA,CAAA,EACyB,OAAA,CAAA,MAAA,EAAA,KAAA,CAAAL,GAAAS,EAAA,OAAA,EAAA,EAC4B,WAAA,EACvC,CACd,EAGFiB,EAAA,IAAAd,EAAAC,EAAAC,EAAAL,CAAA,EAAA,IAAAkB,GAAAC,EAAA,IAEIC,EAAA,GAAU,CAAT,UAAAC,EAAA,UAEoB,MAAA,CAAA,UAAAzB,EAAA,GAAA0B,GAAA7B,EAAAE,EAAA2B,EAAAJ,EAAA,KAAA,CAAA,CAAA,CAAA,EAC2C,SAAAC,EAAA,IAE9D,MAAC,CAAA,UAAAE,EAAA,IACoB,MAAA,CAAA,gBAAA,OAAAH,EAAA,MAAA,CACyB,CAAA,CAC9C,EAAAA,EAAA,KAPS,CAAA,EAWf,OAAAK,EAAAA,KAAA,MAAA,CAAA,UAAAF,EAAA,QAAA,SAAA,CAEIF,EAAAA,IAAA,IAAA,CAAA,UAAAE,EAAA,KAAA,SAAAjB,EAAA,eAAAJ,EAAA,SAAA,iBAAA,CAAA,EAEAmB,EAAAA,IAAA,KAAA,CAAA,UAAAE,EAAA,KAAA,GAAAP,IAAA,SAAAG,EAAA,EAAA,CAGA,CAAA,CAAA,CAGN,4RClFA,MAAeO,EAAA,CACb,MAAO,4BACP,WAAY,CAACC,EAAkB,CAC7B,MAAO,OACP,SAAU,QACX,CAAA,EAAGC,CAAe,CACrB,EACaC,EAAoB,IAAOJ,EAAAA,KAAA,MAAA,CAAI,MAAO,CACjD,QAAS,OACT,iBAAkB,UAClB,WAAY,GACZ,QAAS,EACX,EACI,SAAA,CAAAJ,EAAA,IAACZ,EAAY,EAAA,EACbY,EAAAA,IAACZ,EAAY,CAAA,OAAM,EAAC,CAAA,CAAA,EACtB,QACFoB,EAAkB,WAAa,CAC7B,GAAGA,EAAkB,WACrB,YAAa,CACX,OAAQ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,UACR,IAAGC,EAAAD,EAAkB,aAAlB,YAAAC,EAA8B,WACnC,CACF"}
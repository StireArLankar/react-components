import{j as u,w as ee}from"./withCustomTheme-ab58be2d.js";import{w as te}from"./withCenteredStyle-93f62c3f.js";import{r as d}from"./index-f1f749bf.js";import{f as ne}from"./immer.esm-c7404b5c.js";import{u as L,a as O,t as W}from"./react-spring-web.esm-dd561a21.js";import{a as Z}from"./use-gesture-react.esm-c354a664.js";import{c as N}from"./clamp-3f912b31.js";import"./story.css-e50b5b1c.js";import"./_commonjsHelpers-042e6b4d.js";import"./index-96c5f47c.js";const _={grid:"xv990b2",gridItem:"xv990b3",item:"xv990b4",inner:"xv990b5",frontCard:"xv990b0",backCard:"xv990b0 xv990b1",side:"xv990b7"},q=[{name:"Rare Wind",description:"#a8edea → #fed6e3",css:"linear-gradient(135deg, #a8edea 0%, #fed6e3 100%)"},{name:"Saint Petersburg",description:"#f5f7fa → #c3cfe2",css:"linear-gradient(135deg, #c3cfe2 0%, #c3cfe2 100%)"},{name:"Deep Blue",description:"#e0c3fc → #8ec5fc",css:"linear-gradient(135deg, #e0c3fc 0%, #8ec5fc 100%)"},{name:"Ripe Malinka",description:"#f093fb → #f5576c",css:"linear-gradient(135deg, #f093fb 0%, #f5576c 100%)"},{name:"Near Moon",description:"#5ee7df → #b490ca",css:"linear-gradient(135deg, #5ee7df 0%, #b490ca 100%)"},{name:"Wild Apple",description:"#d299c2 → #fef9d7",css:"linear-gradient(135deg, #d299c2 0%, #fef9d7 100%)"},{name:"Ladoga Bottom",description:"#ebc0fd → #d9ded8",css:"linear-gradient(135deg, #ebc0fd 0%, #d9ded8 100%)"},{name:"Sunny Morning",description:"#f6d365 → #fda085",css:"linear-gradient(120deg, #f6d365 0%, #fda085 100%)"},{name:"Lemon Gate",description:"#96fbc4 → #f9f586",css:"linear-gradient(to top, #96fbc4 0%, #f9f586 100%)"}],H=(r,t,e,a)=>{const n=r%t,i=(r-n)/t;return n>t/2?N(e+i+1,0,a):n<-t/2?N(e+i-1,0,a):N(e+i,0,a)},E=(r,t,e,a,n)=>({x:n?0:r,y:n?0:t,bottom:n?7:e*a+7,right:n?7:e*a+7,scalE:1,zIndeX:n?10:0,shadow:1}),re=(r,t,e,a)=>({x:r,y:t,bottom:e*a+7,right:e*a+7,scalE:1.1,zIndeX:100,shadow:15}),Y=d.memo(r=>{const{index:t,step:e,max:a,position:n,onStart:i,updatePosition:I,active:f,onClick:g}=r,b=d.useRef(!1),[x,c]=d.useState([...n]),[l,C]=L(()=>E(n[0]*e,n[1]*e,a,e)),{x:V,y:S,bottom:k,right:o,scalE:h,zIndeX:m,shadow:y}=l;d.useEffect(()=>{if(!b.current){c([...n]);const s=E(n[0]*e,n[1]*e,a,e,f);C.start(s)}},[n,C,e,f,a]);const p=Z({onClick:()=>void g(t),onDragStart:()=>{b.current=!0,i()},onDragEnd:()=>void(b.current=!1),onDrag:({down:s,movement:[w,z]})=>{const $=H(w,e,x[0],a),j=H(z,e,x[1],a);if(s){const D=re(x[0]*e+w,x[1]*e+z,a,e);C.start(D)}else{c([$,j]);const D=E($*e,j*e,a,e,f);C.start(D)}I(t,$,j)}},{drag:{filterTaps:!0}});return u.jsx(O.div,{...p(),className:_.item,style:{zIndex:m.to(s=>Number(s.toFixed(0))),boxShadow:y.to(s=>`0px ${s}px ${2*s}px 0px rgba(0, 0, 0, 0.3)`),transform:W([S,V,h],(s,w,z)=>`translate3d(${w}px, ${s}px, 0) scale(${z})`),width:"auto",height:"auto",bottom:k,right:o},children:u.jsx("div",{className:_.side,style:{background:q[t].css},children:q[t].name})})});try{Y.displayName="CrazyItem",Y.__docgenInfo={description:"",displayName:"CrazyItem",props:{index:{defaultValue:null,description:"",name:"index",required:!0,type:{name:"number"}},step:{defaultValue:null,description:"",name:"step",required:!0,type:{name:"number"}},max:{defaultValue:null,description:"",name:"max",required:!0,type:{name:"number"}},position:{defaultValue:null,description:"",name:"position",required:!0,type:{name:"[number, number]"}},active:{defaultValue:null,description:"",name:"active",required:!0,type:{name:"boolean"}},onClick:{defaultValue:null,description:"",name:"onClick",required:!0,type:{name:"(index: number) => void"}},onStart:{defaultValue:null,description:"",name:"onStart",required:!0,type:{name:"() => void"}},updatePosition:{defaultValue:null,description:"",name:"updatePosition",required:!0,type:{name:"(index: number, x: number, y: number) => void"}}}}}catch{}const G={y:0,z:0},B=d.memo(r=>{const{index:t,active:e}=r,[{z:a,y:n},i]=L(()=>({from:G,to:G,config:g=>g==="y"?{tension:120,friction:14,clamp:!1}:{tension:50,friction:5,clamp:!0}}));d.useEffect(()=>{if(e){i.start({to:[{z:.5},{y:1,z:1}]});return}i.start({to:G})},[e,i]);const I=()=>u.jsx("div",{className:_.frontCard,children:u.jsx("div",{className:_.side,style:{background:q[t].css},children:t})}),f=()=>u.jsx("div",{className:_.backCard,children:u.jsx("div",{className:_.side,style:{background:q[t].css},children:q[t].name})});return u.jsxs(O.div,{className:_.inner,style:{transform:W([n,a],(g,b)=>`rotateY(${180*g}deg) scale(${1+b})`),boxShadow:a.to(g=>`0px ${15*g}px ${30*g}px 0px rgba(0, 0, 0, 0.7)`)},children:[I(),f()]})});try{B.displayName="Child",B.__docgenInfo={description:"",displayName:"Child",props:{index:{defaultValue:null,description:"",name:"index",required:!0,type:{name:"number"}},active:{defaultValue:null,description:"",name:"active",required:!0,type:{name:"boolean"}}}}}catch{}const J=(r,t,e,a)=>{const n=r%t,i=(r-n)/t;return n>t/2?N(e+i+1,0,a):n<-t/2?N(e+i-1,0,a):N(e+i,0,a)},X=(r,t,e)=>({x:r,y:t,scalE:1,zIndeX:e?10:0,shadow:1}),ae=(r,t)=>({x:r,y:t,scalE:1.1,zIndeX:100,shadow:15}),F=d.memo(r=>{const{index:t,step:e,max:a,position:n,onStart:i,updatePosition:I,active:f,onClick:g}=r,b=d.useRef(!1),[x,c]=d.useState([...n]),[{x:l,y:C,scalE:V,zIndeX:S,shadow:k},o]=L(()=>X(n[0]*e,n[1]*e));d.useEffect(()=>{b.current||(c([...n]),o.start(X(n[0]*e,n[1]*e,f)))},[n,o,e,f]);const h=Z({onClick:()=>void g(t),onDragStart:()=>{b.current=!0,i()},onDragEnd:()=>{b.current=!1},onDrag:({down:m,movement:[y,p]})=>{const s=J(y,e,x[0],a),w=J(p,e,x[1],a);m?o.start(ae(x[0]*e+y,x[1]*e+p)):(c([s,w]),o.start(X(s*e,w*e,f))),I(t,s,w)}},{drag:{filterTaps:!0}});return u.jsx(O.div,{...h(),className:_.item,style:{touchAction:"none",zIndex:S.to(m=>Number(m.toFixed(0))),boxShadow:k.to(m=>`0px ${m}px ${2*m}px 0px rgba(0, 0, 0, 0.3)`),transform:W([C,l,V],(m,y,p)=>`translate3d(${y}px, ${m}px, 0) scale(${p})`)},children:u.jsx(B,{index:t,active:f})})});try{F.displayName="Item",F.__docgenInfo={description:"",displayName:"Item",props:{index:{defaultValue:null,description:"",name:"index",required:!0,type:{name:"number"}},step:{defaultValue:null,description:"",name:"step",required:!0,type:{name:"number"}},max:{defaultValue:null,description:"",name:"max",required:!0,type:{name:"number"}},position:{defaultValue:null,description:"",name:"position",required:!0,type:{name:"[number, number]"}},active:{defaultValue:null,description:"",name:"active",required:!0,type:{name:"boolean"}},onClick:{defaultValue:null,description:"",name:"onClick",required:!0,type:{name:"(index: number) => void"}},onStart:{defaultValue:null,description:"",name:"onStart",required:!0,type:{name:"() => void"}},updatePosition:{defaultValue:null,description:"",name:"updatePosition",required:!0,type:{name:"(index: number, x: number, y: number) => void"}}}}}catch{}const v=4,K=new Array(v*v).fill(-1),A=([r,t])=>t*v+r,T=r=>[r%v,Math.floor(r/v)],se=q.map((r,t)=>T(t)),P=({isCrazy:r})=>{const[t,e]=d.useState(se),[a,n]=d.useState(null),i=d.useCallback(c=>n(l=>l===c?null:c),[]),I=d.useCallback(()=>n(null),[]),f=d.useCallback((c,l,C)=>{e(V=>ne(V,S=>{const k=A(S[c]);let o=A([l,C]);if(k===o)return;const h=K.slice();V.forEach((p,s)=>h[A(p)]=s);let m=!0,y=h[o]!==-1;for(;y;){if(m){m=!1;const s=o-1<0?v*v-1:o-1;if(y=h[s]===-1||s===k,y){S[h[o]]=T(s);break}}const p=o+1>v*v-1?0:o+1;y=h[p]!==-1&&p!==k,S[h[o]]=T(p),o=p}S[c]=[l,C]}))},[]),g=()=>K.map((c,l)=>u.jsx("div",{className:_.gridItem},l)),b=d.useMemo(()=>r?Y:F,[r]),x=()=>t.map((c,l)=>u.jsx(b,{index:l,step:100,max:v-1,position:c,updatePosition:f,onStart:I,active:a===l,onClick:i},l));return u.jsxs("div",{className:_.grid,children:[g(),x()]})};try{P.displayName="ChainedGrid",P.__docgenInfo={description:"",displayName:"ChainedGrid",props:{isCrazy:{defaultValue:null,description:"",name:"isCrazy",required:!1,type:{name:"boolean"}}}}}catch{}const be={title:"Gesture/ChainedDnDGrid",decorators:[te({width:"100vw",height:"100vh",display:"grid",placeItems:"center",overflow:"hidden",background:"#32394e"}),ee],component:P},M=()=>u.jsx(P,{}),R=()=>u.jsx(P,{isCrazy:!0});var Q;M.parameters={...M.parameters,storySource:{source:"() => <ChainedGrid />",...(Q=M.parameters)==null?void 0:Q.storySource}};var U;R.parameters={...R.parameters,storySource:{source:"() => <ChainedGrid isCrazy />",...(U=R.parameters)==null?void 0:U.storySource}};export{M as _ChainedGrid,R as _HeroChainedGrid,be as default};
//# sourceMappingURL=_.story-3821e10c.js.map

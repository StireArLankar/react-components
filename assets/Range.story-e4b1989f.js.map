{"version":3,"file":"Range.story-e4b1989f.js","sources":["../../src/components/gesture/Range/Range.tsx","../../src/components/gesture/Range/RangeSimple.tsx","../../src/components/gesture/Range/Range.story.tsx"],"sourcesContent":["import React, { useRef, useMemo, useEffect } from 'react'\r\nimport useMeasure from 'react-use-measure'\r\n\r\nimport { useSpring, animated, to } from '@react-spring/web'\r\nimport { useDrag } from '@use-gesture/react'\r\n\r\nimport clamp from '~/utils/clamp'\r\n\r\nimport classes from './_classes.css'\r\n\r\nexport const Range = () => {\r\n  const [{ x, s }, spring] = useSpring(() => ({ x: 0, s: 1 }))\r\n\r\n  const draggingControl = useRef(false)\r\n\r\n  const [scrubRef, { width, left }] = useMeasure({ debounce: 100 })\r\n\r\n  const relativePosition = useRef(0)\r\n\r\n  const limits = useMemo(() => [-width / 2, width / 2], [width])\r\n\r\n  const setRelativePosition = (v: number) => {\r\n    relativePosition.current = v / width\r\n  }\r\n\r\n  useEffect(() => {\r\n    spring.start({ x: relativePosition.current * width })\r\n  }, [spring, width])\r\n\r\n  const bindControl = useDrag(\r\n    ({ down, offset: [x] }) => {\r\n      draggingControl.current = down\r\n      spring.start({ x, s: down ? 1.4 : 1 })\r\n      setRelativePosition(x)\r\n    },\r\n    {\r\n      from: () => [x.get(), 0],\r\n      bounds: { left: limits[0], right: limits[1] },\r\n    }\r\n  )\r\n\r\n  const bind = useDrag(\r\n    ({ last, xy: [px], movement: [mx], memo = px - left - width / 2 }) => {\r\n      if (draggingControl.current || last) {\r\n        return\r\n      }\r\n      const x = clamp(memo + mx, limits[0], limits[1])\r\n      spring.start({ x })\r\n      setRelativePosition(x)\r\n      return memo\r\n    }\r\n  )\r\n\r\n  return (\r\n    <animated.div\r\n      className={classes.wrapper}\r\n      style={{\r\n        color: x.to({ range: limits, output: ['#833ab4', '#fcb045'] }),\r\n      }}\r\n    >\r\n      <div ref={scrubRef} className={classes.scrub} {...bind()}>\r\n        <animated.div\r\n          className={classes.control}\r\n          {...bindControl()}\r\n          style={{\r\n            transform: to([x, s], (x, s) => `translateX(${x}px) scale(${s})`),\r\n          }}\r\n        />\r\n      </div>\r\n    </animated.div>\r\n  )\r\n}\r\n","import { useRef, useMemo, useEffect } from 'react'\r\nimport useMeasure from 'react-use-measure'\r\n\r\nimport { useSpring, animated } from '@react-spring/web'\r\nimport { useDrag } from '@use-gesture/react'\r\n\r\nimport clamp from '~/utils/clamp'\r\n\r\nimport classes from './_classes.css'\r\n\r\nexport const RangeSimple = () => {\r\n  const [style, spring] = useSpring(() => ({ x: 0, scale: 1 }))\r\n\r\n  const [scrubRef, { width, left }] = useMeasure({ debounce: 100 })\r\n\r\n  const relativePosition = useRef(0)\r\n\r\n  const limits = useMemo(() => [-width / 2, width / 2], [width])\r\n\r\n  const setRelativePosition = (v: number) =>\r\n    (relativePosition.current = v / width)\r\n\r\n  useEffect(() => {\r\n    spring.start({ x: relativePosition.current * width })\r\n  }, [spring, width])\r\n\r\n  const bind = useDrag(\r\n    ({ down, xy: [px], movement: [mx], memo = px - left - width / 2 }) => {\r\n      const x = clamp(memo + mx, limits[0], limits[1])\r\n      spring.start({ x, scale: down ? 1.4 : 1 })\r\n      setRelativePosition(x)\r\n      return memo\r\n    }\r\n  )\r\n\r\n  return (\r\n    <animated.div\r\n      className={classes.wrapper}\r\n      style={{\r\n        color: style.x.to({\r\n          range: limits,\r\n          output: ['#833ab4', '#fcb045'],\r\n        }),\r\n      }}\r\n    >\r\n      <div ref={scrubRef} className={classes.scrub} {...bind()}>\r\n        <animated.div className={classes.control} style={style} />\r\n      </div>\r\n    </animated.div>\r\n  )\r\n}\r\n","import { withCenteredStyle } from '~/_storybook/withCenteredStyle';\nimport { withCustomTheme } from '~/_storybook/withCustomTheme';\nimport { withTopLabel } from '~/_storybook/withTopLabel';\nimport { storyLink } from '~/theme/theme.css';\nimport { Range } from './Range';\nimport { RangeSimple } from './RangeSimple';\nconst label = <>\r\n    <span>Credits to </span>\r\n    <a className={storyLink} href='https://spectrum.chat/react-spring/general/is-it-possible-to-initiate-dragging-from-a-different-component~88af3c28-0ee7-4e92-9015-df9a61552d07'>\r\n      issue\r\n    </a>\r\n  </>;\nexport default {\n  title: 'Gesture/Range',\n  decorators: [withCenteredStyle({\n    width: '100%',\n    height: '100%'\n  }), withCustomTheme, withTopLabel(label)]\n};\nexport const _Range = () => <Range />;\nexport const _RangeSimle = () => <RangeSimple />;\n_Range.parameters = {\n  ..._Range.parameters,\n  storySource: {\n    source: \"() => <Range />\",\n    ..._Range.parameters?.storySource\n  }\n};\n_RangeSimle.parameters = {\n  ..._RangeSimle.parameters,\n  storySource: {\n    source: \"() => <RangeSimple />\",\n    ..._RangeSimle.parameters?.storySource\n  }\n};"],"names":["Range","x","s","spring","useSpring","draggingControl","useRef","scrubRef","width","left","useMeasure","relativePosition","limits","useMemo","setRelativePosition","v","useEffect","bindControl","useDrag","down","bind","last","px","mx","memo","clamp","jsx","animated","classes","to","RangeSimple","style","label","jsxs","Fragment","storyLink","Range_story","withCenteredStyle","withCustomTheme","withTopLabel","_Range","_RangeSimle","_a"],"mappings":"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"}
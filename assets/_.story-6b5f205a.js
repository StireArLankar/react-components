import{j as u,w as me}from"./withCustomTheme-ab58be2d.js";import{w as pe}from"./withCenteredStyle-93f62c3f.js";import{r as b}from"./index-f1f749bf.js";import{f as F}from"./immer.esm-c7404b5c.js";import{u as M,a as k,t as Y}from"./react-spring-web.esm-dd561a21.js";import{u as U}from"./use-gesture-react.esm-c354a664.js";import{c as w}from"./clamp-3f912b31.js";import"./story.css-e50b5b1c.js";import"./_commonjsHelpers-042e6b4d.js";import"./index-96c5f47c.js";const g={grid:"_1hlc3yv0",gridItem:"_1hlc3yv1",item:"_1hlc3yv2",count:"_1hlc3yv3"},Z=(t,n,e,a)=>{const s=t%n,p=(t-s)/n;return s>n/2?w(e+p+1,0,a):s<-n/2?w(e+p-1,0,a):w(e+p,0,a)},j=t=>{const{index:n,step:e,max:a,position:s,updatePosition:p}=t,x=(c,I)=>p(n,c,I),f=b.useRef(!1),[h,y]=b.useState([...s]),[{x:r,y:i,scalE:l,zIndeX:_,shadow:d},o]=M(()=>({x:s[0]*e,y:s[1]*e,scalE:1,zIndeX:0,shadow:1}));b.useEffect(()=>{f.current||(y([...s]),o.start({x:s[0]*e,y:s[1]*e,scalE:1,zIndeX:0,shadow:1}))},[s,o,e]);const m=U(({down:c,movement:[I,D]})=>{const z=Z(I,e,h[0],a),$=Z(D,e,h[1],a);c?(f.current=!0,o.start({x:h[0]*e+I,y:h[1]*e+D,scalE:1.1,zIndeX:100,shadow:15})):(f.current=!1,y([z,$]),o.start({x:z*e,y:$*e,scalE:1,zIndeX:0,shadow:1})),x(z,$)});return u.jsx(k.div,{...m(),className:g.item,style:{zIndex:_.to(c=>Number(c.toFixed(0))),boxShadow:d.to(c=>`0px ${c}px ${2*c}px 0px rgba(0, 0, 0, 0.3)`),transform:Y([i,r,l],(c,I,D)=>`translate3d(${I}px, ${c}px, 0) scale(${D})`)},children:u.jsx("span",{className:g.count,children:n})})};try{j.displayName="Item",j.__docgenInfo={description:"",displayName:"Item",props:{index:{defaultValue:null,description:"",name:"index",required:!0,type:{name:"number"}},step:{defaultValue:null,description:"",name:"step",required:!0,type:{name:"number"}},max:{defaultValue:null,description:"",name:"max",required:!0,type:{name:"number"}},position:{defaultValue:null,description:"",name:"position",required:!0,type:{name:"[number, number]"}},updatePosition:{defaultValue:null,description:"",name:"updatePosition",required:!0,type:{name:"(index: number, x: number, y: number) => void"}}}}}catch{}const ee=(t,n,e,a)=>{const s=t%n,p=(t-s)/n;return s>n/2?w(e+p+1,0,a):s<-n/2?w(e+p-1,0,a):w(e+p,0,a)},P=t=>{const{index:n,step:e,max:a,position:s,updatePosition:p}=t,x=(d,o)=>p(n,d,o),[{x:f,y:h,scalE:y,zIndeX:r,shadow:i},l]=M(()=>({x:s[0]*e,y:s[1]*e,scalE:1,zIndeX:0,shadow:1}));b.useEffect(()=>{l.start({x:s[0]*e,y:s[1]*e,scalE:1,zIndeX:0,shadow:1})},[s,l,e]);const _=U(({down:d,movement:[o,m]})=>{if(d)l.start({x:s[0]*e+o,y:s[1]*e+m,scalE:1.1,zIndeX:100,shadow:15});else{const c=ee(o,e,s[0],a),I=ee(m,e,s[1],a);c===s[0]&&I===s[1]&&l.start({x:s[0]*e,y:s[1]*e,scalE:1,zIndeX:0,shadow:1}),x(c,I)}});return u.jsx(k.div,{..._(),className:g.item,style:{zIndex:r.to(d=>Number(d.toFixed(0))),boxShadow:i.to(d=>`0px ${d}px ${2*d}px 0px rgba(0, 0, 0, 0.3)`),transform:Y([h,f,y],(d,o,m)=>`translate3d(${o}px, ${d}px, 0) scale(${m})`)},children:u.jsx("span",{className:g.count,children:n})})};try{P.displayName="LazyItem",P.__docgenInfo={description:"",displayName:"LazyItem",props:{index:{defaultValue:null,description:"",name:"index",required:!0,type:{name:"number"}},step:{defaultValue:null,description:"",name:"step",required:!0,type:{name:"number"}},max:{defaultValue:null,description:"",name:"max",required:!0,type:{name:"number"}},position:{defaultValue:null,description:"",name:"position",required:!0,type:{name:"[number, number]"}},updatePosition:{defaultValue:null,description:"",name:"updatePosition",required:!0,type:{name:"(index: number, x: number, y: number) => void"}}}}}catch{}const S=4,te=new Array(S*S).fill(0),E=([t,n])=>n*S+t,H=t=>[t%S,Math.floor(t/S)],fe=t=>t.map((n,e)=>H(e)),C=t=>{const{lazy:n}=t,[e,a]=b.useState(()=>fe(te)),s=b.useCallback((y,r,i)=>{a(l=>F(l,_=>{const d=E(_[y]),o=E([r,i]);d!==o&&(l.forEach((m,c)=>{const I=E(m);I>d&&I<=o&&(_[c]=H(I-1)),I<d&&I>=o&&(_[c]=H(I+1))}),_[y]=[r,i])}))},[]),p=b.useMemo(()=>n?P:j,[n]),x=e.reduce((y,r)=>{const i=E(r);return y[i]++,y},[...te]),f=()=>x.map((y,r)=>u.jsx("div",{className:g.gridItem},r)),h=()=>e.map((y,r)=>u.jsx(p,{index:r,step:100,max:3,position:y,updatePosition:s},r));return u.jsxs("div",{className:g.grid,children:[f(),h()]})};try{C.displayName="FilledDnDGrid",C.__docgenInfo={description:"",displayName:"FilledDnDGrid",props:{lazy:{defaultValue:null,description:"",name:"lazy",required:!1,type:{name:"boolean"}}}}}catch{}const G=4,se=new Array(G*G).fill(-1),v=([t,n])=>n*G+t,ue=t=>[t%G,Math.floor(t/G)],ye=t=>t.map((n,e)=>ue(e)),xe=[[0,0],[1,2],[3,2],[2,3],[0,1],[0,2],[1,0]],J=t=>{const{lazy:n,full:e}=t,[a,s]=b.useState([]);b.useEffect(()=>{s(e?ye(se):xe)},[e]);const p=b.useCallback((r,i,l)=>{s(_=>F(_,d=>{const o=v(d[r]);let m=v([i,l]);if(o===m)return;const c=_.findIndex(I=>v(I)===m);d[c]=ue(o),d[r]=[i,l]}))},[]),x=b.useMemo(()=>n?P:j,[n]),f=a.reduce((r,i)=>{const l=v(i);return r[l]++,r},[...se]),h=()=>f.map((r,i)=>u.jsx("div",{className:g.gridItem},i)),y=()=>a.map((r,i)=>u.jsx(x,{index:i,step:100,max:3,position:r,updatePosition:p},i));return u.jsxs("div",{className:g.grid,children:[h(),y()]})};try{J.displayName="SwapDnDGrid",J.__docgenInfo={description:"",displayName:"SwapDnDGrid",props:{lazy:{defaultValue:null,description:"",name:"lazy",required:!1,type:{name:"boolean"}},full:{defaultValue:null,description:"",name:"full",required:!1,type:{name:"boolean"}}}}}catch{}const N=4,L=new Array(N*N).fill(-1),V=([t,n])=>n*N+t,K=t=>[t%N,Math.floor(t/N)],_e=t=>t.map((n,e)=>K(e)),Ie=[[0,0],[1,2],[3,2],[2,3],[0,1],[0,2],[1,0]],Q=t=>{const{lazy:n,full:e}=t,[a,s]=b.useState([]);b.useEffect(()=>{s(e?_e(L):Ie)},[e]);const p=b.useCallback((r,i,l)=>{s(_=>F(_,d=>{const o=V(d[r]);let m=V([i,l]);if(o===m)return;const c=L.slice();_.forEach((z,$)=>c[V(z)]=$);let I=!0,D=c[m]!==-1;for(;D;){if(I){I=!1;const $=m-1<0?N*N-1:m-1;if(D=c[$]===-1||$===o,D){d[c[m]]=K($);break}}const z=m+1>N*N-1?0:m+1;D=c[z]!==-1&&z!==o,d[c[m]]=K(z),m=z}d[r]=[i,l]}))},[]),x=b.useMemo(()=>n?P:j,[n]),f=a.reduce((r,i)=>{const l=V(i);return r[l]++,r},[...L]),h=()=>f.map((r,i)=>u.jsx("div",{className:g.gridItem},i)),y=()=>a.map((r,i)=>u.jsx(x,{index:i,step:100,max:3,position:r,updatePosition:p},i));return u.jsxs("div",{className:g.grid,children:[h(),y()]})};try{Q.displayName="UnfilledDnDGrid",Q.__docgenInfo={description:"",displayName:"UnfilledDnDGrid",props:{lazy:{defaultValue:null,description:"",name:"lazy",required:!1,type:{name:"boolean"}},full:{defaultValue:null,description:"",name:"full",required:!1,type:{name:"boolean"}}}}}catch{}const ne=(t,n,e,a)=>{const s=t%n,p=(t-s)/n;return s>n/2?w(e+p+1,0,a):s<-n/2?w(e+p-1,0,a):w(e+p,0,a)},W=t=>{const{index:n,step:e,max:a,position:s,updatePosition:p}=t,x=(o,m)=>p(n,o,m),[{x:f,y:h,scalE:y,zIndeX:r,shadow:i,opacity:l},_]=M(()=>({x:s[0]*e,y:s[1]*e,scalE:1,zIndeX:0,shadow:1,opacity:.6}));b.useEffect(()=>{_.start({x:s[0]*e,y:s[1]*e,scalE:1,zIndeX:0,shadow:1,opacity:.6})},[s,_,e]);const d=U(({down:o,movement:[m,c]})=>{if(o)_.start({x:s[0]*e+m,y:s[1]*e+c,scalE:1.1,zIndeX:100,shadow:15,opacity:1});else{const I=ne(m,e,s[0],a),D=ne(c,e,s[1],a);x(I,D)}});return u.jsx(k.div,{...d(),className:g.item,style:{zIndex:r.to(o=>Number(o.toFixed(0))),boxShadow:i.to(o=>`0px ${o}px ${2*o}px 0px rgba(0, 0, 0, 0.3)`),transform:Y([h,f,y],(o,m,c)=>`translate3d(${m}px, ${o}px, 0) scale(${c})`),opacity:l}})};try{W.displayName="ConnectedItem",W.__docgenInfo={description:"",displayName:"ConnectedItem",props:{index:{defaultValue:null,description:"",name:"index",required:!0,type:{name:"number"}},step:{defaultValue:null,description:"",name:"step",required:!0,type:{name:"number"}},max:{defaultValue:null,description:"",name:"max",required:!0,type:{name:"number"}},position:{defaultValue:null,description:"",name:"position",required:!0,type:{name:"[number, number]"}},updatePosition:{defaultValue:null,description:"",name:"updatePosition",required:!0,type:{name:"(index: number, x: number, y: number) => void"}}}}}catch{}const he=new Array(16).fill(0),be=()=>{const[t,n]=b.useState(()=>[[0,0],[1,2],[2,2],[1,2],[1,2],[3,2]]),e=b.useCallback((x,f,h)=>{n(y=>F(y,r=>{r[x]=[f,h]}))},[]),a=t.reduce((x,f)=>{const h=f[0]+f[1]*4;return x[h]++,x},[...he]),s=()=>a.map((x,f)=>u.jsx("div",{className:g.gridItem,children:u.jsx("span",{className:g.count,children:x>0?x:null})},f)),p=()=>t.map((x,f)=>u.jsx(W,{index:f,step:100,max:3,position:x,updatePosition:e},f));return u.jsxs("div",{className:g.grid,children:[s(),p()]})},re=(t,n,e,a)=>{const s=t%n;return s>n/2?w(e+t-s+n,0,a*n):s<-n/2?w(e+t-s-n,0,a*n):w(e+t-s,0,a*n)},A=t=>{const{index:n,step:e,max:a}=t,[{x:s,y:p,scalE:x,zIndeX:f,shadow:h},y]=M(()=>({x:n*e,y:0,scalE:1,zIndeX:0,shadow:1})),r=b.useRef({x:n*e,y:0}),i=U(({down:l,movement:[_,d]})=>{l?y.start({x:r.current.x+_,y:r.current.y+d,scalE:1.1,zIndeX:100,shadow:15}):(r.current.x=re(_,e,r.current.x,a),r.current.y=re(d,e,r.current.y,a),y.start({x:r.current.x,y:r.current.y,scalE:1,zIndeX:0,shadow:1}))});return u.jsx(k.div,{...i(),className:g.item,style:{zIndex:f.to(l=>Number(l.toFixed(0))),boxShadow:h.to(l=>`0px ${l}px ${2*l}px 0px rgba(0, 0, 0, 0.3)`),transform:Y([p,s,x],(l,_,d)=>`translate3d(${_}px, ${l}px, 0) scale(${d})`)}})};try{A.displayName="Item",A.__docgenInfo={description:"",displayName:"Item",props:{index:{defaultValue:null,description:"",name:"index",required:!0,type:{name:"number"}},step:{defaultValue:null,description:"",name:"step",required:!0,type:{name:"number"}},max:{defaultValue:null,description:"",name:"max",required:!0,type:{name:"number"}}}}}catch{}const ge=new Array(16).fill(""),we=()=>{const t=()=>ge.map((n,e)=>u.jsx("div",{className:g.gridItem},e));return u.jsxs("div",{className:g.grid,children:[t(),u.jsx(A,{index:0,step:100,max:4-1}),u.jsx(A,{index:1,step:100,max:4-1})]})},qe={title:"Gesture/DnDGrid",decorators:[pe({width:"100vw",height:"100vh",display:"grid",placeItems:"center",overflow:"hidden",background:"#32394e"}),me]},R=()=>u.jsx(we,{}),T=()=>u.jsx(be,{}),O=()=>u.jsx(C,{lazy:!0}),B=()=>u.jsx(C,{}),De=t=>u.jsx(Q,{...t}),X=De.bind({});X.args={full:!1,lazy:!1};const ze=t=>u.jsx(J,{...t}),q=ze.bind({});q.args={full:!1,lazy:!1};var ae;R.parameters={...R.parameters,storySource:{source:"() => <DnDGrid />",...(ae=R.parameters)==null?void 0:ae.storySource}};var oe;T.parameters={...T.parameters,storySource:{source:"() => <StatefulDnDGrid />",...(oe=T.parameters)==null?void 0:oe.storySource}};var ie;O.parameters={...O.parameters,storySource:{source:"() => <FilledDnDGrid lazy />",...(ie=O.parameters)==null?void 0:ie.storySource}};var de;B.parameters={...B.parameters,storySource:{source:"() => <FilledDnDGrid />",...(de=B.parameters)==null?void 0:de.storySource}};var le;X.parameters={...X.parameters,storySource:{source:"props => <UnfilledDnDGrid {...props} />",...(le=X.parameters)==null?void 0:le.storySource}};var ce;q.parameters={...q.parameters,storySource:{source:"props => <SwapDnDGrid {...props} />",...(ce=q.parameters)==null?void 0:ce.storySource}};export{R as _DndGrid,B as _FilledDndGrid,O as _FilledLazyDndGrid,T as _StatefulDndGrid,q as _SwapDndGrid,X as _UnfilledDndGrid,qe as default};
//# sourceMappingURL=_.story-6b5f205a.js.map

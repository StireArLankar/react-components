{"version":3,"file":"_.story-ef539fbd.js","sources":["../../src/utils/move.ts","../../src/components/gesture/DragnDrop/index.tsx","../../src/components/gesture/DragnDrop/_.story.tsx"],"sourcesContent":["export function move<T>(array: T[], moveIndex: number, toIndex: number) {\r\n  let item = array[moveIndex]\r\n  let length = array.length\r\n  let diff = moveIndex - toIndex\r\n\r\n  if (diff > 0) {\r\n    // move left\r\n    return [\r\n      ...array.slice(0, toIndex),\r\n      item,\r\n      ...array.slice(toIndex, moveIndex),\r\n      ...array.slice(moveIndex + 1, length),\r\n    ]\r\n  } else if (diff < 0) {\r\n    // move right\r\n    return [\r\n      ...array.slice(0, moveIndex),\r\n      ...array.slice(moveIndex + 1, toIndex + 1),\r\n      item,\r\n      ...array.slice(toIndex + 1, length),\r\n    ]\r\n  }\r\n\r\n  return array\r\n}\r\n\r\nexport default move\r\n","import { useState } from 'react'\r\n\r\nimport { useSprings, animated, to } from '@react-spring/web'\r\nimport { useDrag } from '@use-gesture/react'\r\n\r\nimport clamp from '~/utils/clamp'\r\nimport swap from '~/utils/move'\r\n\r\nimport classes from './_classes.css'\r\n\r\nconst immediate = (key: string) => key === 'y' || key === 'zIndex'\r\nconst notImmediate = () => false\r\n\r\nconst fn =\r\n  (\r\n    order: number[],\r\n    down?: boolean,\r\n    originalIndex?: number,\r\n    curIndex: number = 0,\r\n    y: number = 0\r\n  ) =>\r\n  (index: number) => {\r\n    if (down && index === originalIndex) {\r\n      return {\r\n        y: curIndex * 100 + y,\r\n        scale: 1.1,\r\n        zIndex: 100,\r\n        shadow: 15,\r\n        immediate: immediate,\r\n      }\r\n    }\r\n\r\n    return {\r\n      y: order.indexOf(index) * 100,\r\n      scale: 1,\r\n      zIndex: 0,\r\n      shadow: 1,\r\n      immediate: notImmediate,\r\n    }\r\n  }\r\n\r\nconst items = 'Lorem ipsum dolor sit'.split(' ')\r\n\r\nexport const DragnDrop = () => {\r\n  const [state, setState] = useState(items.map((_, index) => index))\r\n\r\n  const [springs, setSprings] = useSprings(items.length, fn(state))\r\n\r\n  const bind = useDrag(({ args: [originalIndex], down, movement: [, y] }) => {\r\n    const curIndex = state.indexOf(originalIndex)\r\n\r\n    const curRow = clamp(\r\n      Math.round((curIndex * 100 + y) / 100),\r\n      0,\r\n      items.length - 1\r\n    )\r\n\r\n    const newOrder = swap(state, curIndex, curRow)\r\n\r\n    setSprings.start(fn(newOrder, down, originalIndex, curIndex, y))\r\n\r\n    if (!down) {\r\n      setState(newOrder)\r\n    }\r\n  })\r\n\r\n  return (\r\n    <div className={classes.wrapper} style={{ height: items.length * 100 }}>\r\n      {springs.map(({ zIndex, shadow, y, scale }, i) => (\r\n        <animated.div\r\n          {...bind(i)}\r\n          key={i}\r\n          className={classes.item}\r\n          style={{\r\n            touchAction: 'none',\r\n            zIndex: zIndex.to((val) => Number(val.toFixed(0))),\r\n            boxShadow: shadow.to(\r\n              (s) => `0px ${s}px ${2 * s}px 0px rgba(0, 0, 0, 0.3) `\r\n            ),\r\n            transform: to(\r\n              [y, scale],\r\n              (y, scale) => `translate3d(0, ${y}px, 0) scale(${scale})`\r\n            ),\r\n          }}\r\n          children={items[i]}\r\n        />\r\n      ))}\r\n    </div>\r\n  )\r\n}\r\n","import { withCenteredStyle } from '~/_storybook/withCenteredStyle';\nimport { withCustomTheme } from '~/_storybook/withCustomTheme';\nimport { withTopLabel } from '~/_storybook/withTopLabel';\nimport { storyLink } from '~/theme/theme.css';\nimport { DragnDrop } from '.';\nconst label = <>\r\n    <span>Credits to </span>\r\n    <a className={storyLink} href='https://github.com/react-spring/react-use-gesture'>\r\n      docs\r\n    </a>\r\n  </>;\nexport default {\n  title: 'Gesture/DragnDrop',\n  decorators: [withCenteredStyle({\n    width: '100vw',\n    backgroundColor: '#f7f7f7',\n    position: 'fixed',\n    minHeight: '100vh',\n    padding: 50\n  }), withCustomTheme, withTopLabel(label)]\n};\nexport const _DragnDrop = () => <DragnDrop />;\n_DragnDrop.parameters = {\n  ..._DragnDrop.parameters,\n  storySource: {\n    source: \"() => <DragnDrop />\",\n    ..._DragnDrop.parameters?.storySource\n  }\n};"],"names":["move","array","moveIndex","toIndex","item","length","diff","immediate","key","notImmediate","fn","order","down","originalIndex","curIndex","y","index","items","DragnDrop","state","setState","useState","_","springs","setSprings","useSprings","bind","useDrag","curRow","clamp","newOrder","swap","jsx","classes","zIndex","shadow","scale","i","createElement","animated","val","s","to","label","jsxs","Fragment","storyLink","__story","withCenteredStyle","withCustomTheme","withTopLabel","_DragnDrop","_a"],"mappings":"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"}
{"version":3,"file":"Lense.story-82a90fb6.js","sources":["../../src/components/native/Lense/Handler.tsx","../../src/components/native/Lense/View.tsx","../../src/components/native/Lense/Controller.tsx","../../src/components/native/Lense/index.tsx","../../src/components/native/Lense/Lense.story.tsx"],"sourcesContent":["import React, { useRef } from 'react'\r\n\r\nimport style from './lense.module.scss'\r\n\r\ntype Props = {\r\n  x: number\r\n  y: number\r\n  url: string\r\n  lenseSize: number\r\n\r\n  changeCoords: (x: number, y: number) => void\r\n}\r\n\r\nconst Handler = (props: Props) => {\r\n  const ref = useRef<HTMLDivElement>(null)\r\n\r\n  const onMouseDown = (downE: React.MouseEvent<HTMLDivElement>) => {\r\n    downE.preventDefault()\r\n    const handler = ref.current\r\n\r\n    if (!handler) {\r\n      return\r\n    }\r\n\r\n    const { x: handlerX, y: handlerY } = handler.getBoundingClientRect()\r\n    const { clientHeight, clientWidth } = handler\r\n\r\n    const width = clientWidth - props.lenseSize\r\n    const height = clientHeight - props.lenseSize\r\n\r\n    const getX = (e: MouseEvent) =>\r\n      (e.clientX - handlerX - props.lenseSize / 2) / width\r\n    const getY = (e: MouseEvent) =>\r\n      (e.clientY - handlerY - props.lenseSize / 2) / height\r\n\r\n    let x = getX(downE as unknown as MouseEvent)\r\n    let y = getY(downE as unknown as MouseEvent)\r\n\r\n    const onMouseMove = (moveE: MouseEvent) => {\r\n      x = getX(moveE)\r\n      y = getY(moveE)\r\n\r\n      const xCheck = x >= 0 ? (x <= 1 ? x : 1) : 0\r\n      const yCheck = y >= 0 ? (y <= 1 ? y : 1) : 0\r\n\r\n      props.changeCoords(xCheck, yCheck)\r\n    }\r\n\r\n    const onMouseUp = () => {\r\n      document.removeEventListener('mousemove', onMouseMove)\r\n      document.removeEventListener('mouseup', onMouseUp)\r\n    }\r\n\r\n    document.addEventListener('mousemove', onMouseMove)\r\n    document.addEventListener('mouseup', onMouseUp)\r\n  }\r\n\r\n  const { url, x, y } = props\r\n\r\n  const dynamicStyle: React.CSSProperties = {\r\n    top: `${y * 100}%`,\r\n    left: `${x * 100}%`,\r\n  }\r\n\r\n  return (\r\n    <div className={style.handler} onMouseDown={onMouseDown} ref={ref}>\r\n      <img src={url} alt='' className={style.handlerImg} />\r\n      <div className={style.border}>\r\n        <div className={style.lense} style={dynamicStyle} />\r\n      </div>\r\n    </div>\r\n  )\r\n}\r\n\r\nexport default Handler\r\n","import React from 'react'\r\n\r\nimport style from './lense.module.scss'\r\n\r\ntype Props = {\r\n  size: number\r\n  lenseSize: number\r\n  url: string\r\n  x: number\r\n  y: number\r\n}\r\n\r\nconst View = (props: Props) => {\r\n  const { x, y, url, size, lenseSize } = props\r\n  const offset = (size * size) / lenseSize - size\r\n\r\n  const dynamicStyle: React.CSSProperties = {\r\n    transform: `translate(-${x * offset}px, -${y * offset}px)`,\r\n    width: `${(size * size) / lenseSize}px`,\r\n    height: `${(size * size) / lenseSize}px`,\r\n  }\r\n\r\n  return (\r\n    <div className={style.view}>\r\n      <div className={style.viewWrapper} style={dynamicStyle}>\r\n        <img src={url} alt='' className={style.viewImg} />\r\n      </div>\r\n    </div>\r\n  )\r\n}\r\n\r\nexport default View\r\n","import React, { useState } from 'react'\r\n\r\nimport Handler from './Handler'\r\nimport style from './lense.module.scss'\r\nimport View from './View'\r\n\r\ntype Props = {\r\n  size: number\r\n  lenseSize: number\r\n  url: string\r\n}\r\n\r\nconst Controller = (props: Props) => {\r\n  const [coords, setCoords] = useState({ x: 0, y: 0 })\r\n  const { size, lenseSize, url } = props\r\n\r\n  const changeCoords = (x: number, y: number) => setCoords({ x, y })\r\n\r\n  const dynamicStyle: React.CSSProperties = {\r\n    ['--size' as any]: `${size}px`,\r\n    ['--lense-size' as any]: `${lenseSize}px`,\r\n  }\r\n\r\n  return (\r\n    <div className={style.wrapper} style={dynamicStyle}>\r\n      <Handler\r\n        changeCoords={changeCoords}\r\n        x={coords.x}\r\n        y={coords.y}\r\n        url={url}\r\n        lenseSize={lenseSize}\r\n      />\r\n      <View\r\n        x={coords.x}\r\n        y={coords.y}\r\n        url={url}\r\n        size={size}\r\n        lenseSize={lenseSize}\r\n      />\r\n    </div>\r\n  )\r\n}\r\n\r\nexport default Controller\r\n","import React, { useState, ChangeEvent, Fragment } from 'react'\r\n\r\nimport useBGColor from '~/hook/useBgColor'\r\n\r\nimport Controller from './Controller'\r\nimport classes from './lense.module.scss'\r\n\r\nexport const LenseContainer = () => {\r\n  const [size, setSize] = useState(200)\r\n  const [lenseSize, setLenseSize] = useState(50)\r\n  const [url] = useState(\r\n    'https://stirearlankar.github.io/54729-kekstagram/photos/14.jpg'\r\n  )\r\n\r\n  useBGColor(197, 241, 246)\r\n\r\n  const evtHandler =\r\n    (callback: (num: number) => void) =>\r\n    (evt: ChangeEvent<HTMLInputElement>) => {\r\n      const value = +evt.target.value\r\n      if (isNaN(value)) {\r\n        return\r\n      }\r\n      callback(value)\r\n    }\r\n\r\n  const onSizeChange = evtHandler(setSize)\r\n  const onLenseSizeChange = evtHandler(setLenseSize)\r\n\r\n  return (\r\n    <Fragment>\r\n      <div className={classes.container}>\r\n        <Controller size={size} lenseSize={lenseSize} url={url} />\r\n      </div>\r\n      <div className={classes.controls}>\r\n        <label className={classes.label}>\r\n          <span className={classes.labelText}>Размер изображений</span>\r\n          <input type='text' value={size} onChange={onSizeChange} />\r\n        </label>\r\n        <label className={classes.label}>\r\n          <span className={classes.labelText}>Размер линзы</span>\r\n          <input type='text' value={lenseSize} onChange={onLenseSizeChange} />\r\n        </label>\r\n      </div>\r\n    </Fragment>\r\n  )\r\n}\r\n\r\nexport default LenseContainer\r\n","import { withCenteredStyle } from '~/_storybook/withCenteredStyle';\nimport { withCustomTheme } from '~/_storybook/withCustomTheme';\nimport { LenseContainer } from '.';\nexport default {\n  title: 'Native/Lense',\n  decorators: [withCenteredStyle({\n    width: '100%',\n    padding: 20,\n    flexDirection: 'column'\n  }), withCustomTheme]\n};\nexport const Example = () => <LenseContainer />;\nExample.parameters = {\n  ...Example.parameters,\n  storySource: {\n    source: \"() => <LenseContainer />\",\n    ...Example.parameters?.storySource\n  }\n};"],"names":["Handler","props","ref","useRef","onMouseDown","downE","handler","handlerX","handlerY","clientHeight","clientWidth","width","height","getX","e","getY","x2","y2","onMouseMove","moveE","xCheck","yCheck","onMouseUp","url","x","y","dynamicStyle","jsxs","style","jsx","View","size","lenseSize","offset","Controller","coords","setCoords","useState","changeCoords","LenseContainer","setSize","setLenseSize","useBGColor","evtHandler","callback","evt","value","onSizeChange","onLenseSizeChange","Fragment","classes","Lense_story","withCenteredStyle","withCustomTheme","Example","_a"],"mappings":"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"}